{% extends 'shiling/base.html' %}
{% block mainbody %}
<div class="detail">
	<form role="form" method="POST" enctype="multipart/form-data" id="formid">
	{% csrf_token %}
	<div class="retrieve-password">
		<div class="retrieve-password-hd">
			<h5>必填信息</h5>
		</div>
		<div class="retrieve-password-bd">
			<ul>
				<li class="head-portrait">
					<div>
						<input type="text" name="phone" id="phone" placeholder="手机号码" class="text-style" />
					</div>
				</li>
				<li class="security-code">
					<ul>
						<li>
							<div class="left">
								<input type="text" name="" placeholder="验证码" class="text-style" />
							</div>
						</li>
						<li>
							<div class="right">
								<h3>获取验证码</h3>
							</div>
						</li>
						<div class="clear"></div>
					</ul>
				</li>
			</ul>
		</div>
	</div>
	<div class="retrieve-password">
		<div class="retrieve-password-hd">
			<h5>密码</h5>
		</div>
		<div class="retrieve-password-bd">
			<input type="text" name="pwd" id="pwd" placeholder="输入密码，至少6位" class="text-style" />
		</div>
	</div>
	<div class="provide-btn">
		<div class="button01">
			<a id="submit"><h3>注册</h3></a>
		</div>
	</div>
	</form>
</div>
{% endblock %}
{% block script %}
<script>
	$(function(){
		//验证手机号码
	    var checkphone = function(phone){
			 var reg = /^0?1[3|4|5|8][0-9]\d{8}$/;
			 if (reg.test(phone)) {
			      return true;
			 }else{
			      return false;
			 }
	    }
		$("#submit").on('click',function(){
			var phone = $("#phone").val()
			var pwd = $("#pwd").val()
			if (!phone || !pwd) {
				alert("请输入完整信息")
				return false
			}
			if (!checkphone(phone)) {
				alert("请输入正确手机号")
				return false
			}
			//校验手机是否已注册
			$.ajax({
				url:"http://localhost:8000/phone/"+phone,
				method:'GET',
				success:function(msg){
					if (msg == 1) {
						alert("该手机号码已注册,请登录")
					}else{
						$("#formid").submit()
					}
					
				},
			})
		})
	})
</script>
{% endblock %}