{% extends 'shiling/base.html' %}
{% block mainbody %}
	<div class="nav">
		<ul class="text">			
			<li><a href="/index" {% if not module or module == 'shouye' %}class="action" {% endif %}>首页</a></li>
			<li><a href="/provide" {% if module == 'provide' %}class="action" {% endif %}>供养</a></li>
			<li><a href="/goodraise" {% if module == 'goodraise' %}class="action" {% endif %}>善筹</a></li>
			<li><a href="/blessing" {% if module == 'blessing' %}class="action" {% endif %}>祈福</a></li>
			<li><a href="/activity" {% if module == 'activity' %}class="action" {% endif %}>活动</a></li>
			<li><a href="/news" {% if module == 'news' %}class="action" {% endif %}>新闻</a></li>
			<li><a href="/volunteer" {% if module == 'volunteer' %}class="action" {% endif %}>义工</a></li>
			<li><a href="/buddhismknowledge" {% if module == 'buddhismknowledge' %}class="action" {% endif %}>佛教知识</a></li>
		</ul>
		<div class="user"><a href="/login">
			<img src="/static/images/user-icon.png" width="26">
		</a></div>
	</div>
	<div class="event">
		<div class="hd">
			<h2>{{volunteer.title}}</h2>
			<div class="news-info">
				<ul>
					<li>
						<img src="images/look.png" width="14">&nbsp168						
					</li>
					<li>
						<span>&nbsp&nbsp|&nbsp&nbsp</span>
					</li>
					<li>
						<img src="images/clock.png" width="10">{{volunteer.end_time}}
					</li>
					<div class="clear"></div>
				</ul>
			</div>
			<div class="start">
				<span>查看报名名单</span>
			</div>
			<div class="clear"></div>
		</div>
		<div class="form">
			<table cellspacing="0" cellpadding="0">
				<tr>
    				<td class="title">人数</td>
   					<td class="text">2/{{volunteer.people_number}}</td>
				</tr>
 				<tr>
					<td class="title">地址</td>
					<td class="text">{{volunteer.address}}</td>
				</tr>
				<tr>
					<td class="title">时间</td>
					<td class="text">{{volunteer.start_time}}～{{volunteer.end_time}}</td>
				</tr>
			</table>
		</div>
		<div class="event-content">
			<div class="content">
				<div class="abbot-box">
					<div class="introduce-abbot">
						<h1>{{volunteer.name}}</h1>
 						<div class="">
 							{{volunteer.content}}
 						</div>
						<img src="http://placehold.it/335x132" width="100%">
					</div>
				</div>
			</div>
		</div>
		<div class="provide-btn">
			<div class="button01">
			<a ><h3>登记报名</h3></a>
		</div>
	</div>

	
<!-- 信息登记 -->

<div class="pop1">
	<div class="translucent"></div>
	<div class="apply">
		<div class="apply-hd">
			<h2>信息登记</h2>
			<a id="close1"><img src="/static/images/close.png" width="14"></a>
		</div>
		<div>
			<ul>
				<li>
					<div class="apply-info">
						<input type="text" name="name" id="name" placeholder="姓名" class="text-style" />
					</div>
				</li>
				<li>
					<div class="apply-info">
						<input type="text" name="phone" id="phone" placeholder="电话" class="text-style" />
					</div>
				</li>
			</ul>
		</div>
		<div class="provide-btn" id="pop1-btn">
			<div class="button01">
				<a><h3>报名</h3></a>
			</div>
		</div>
	</div>
</div>

<!-- 报名名单 -->

<div class="pop2">
	<div class="translucent"></div>
	<div class="apply">
		<div class="apply-hd">
			<h2>{{volunteer.title}}</h2>
			<h4>(2/{{volunteer.people_number}})</h4>
		</div>
		<a id="close2"><img src="/static/images/close.png" width="14"></a>
		<div class="sign-up">
			<ul>
				{% for volunteeruser in volunteerusers %}
				<li>
					<div class="apply-info">
						<ul>
							<li>
								<div class="vertica">
								</div>
							</li>
							<li class="grey">
								<h3>{{volunteeruser.name}}</h3>
							</li>
							<div class="clear"></div>
						</ul>
					</div>
				</li>
				{% endfor %}
			</ul>
		</div>
	</div>
</div>
{% endblock %}
{% block script %}
<script>
	$(function(){
		//验证手机号码
	    var checkphone = function(phone){
			 var reg = /^0?1[3|4|5|8][0-9]\d{8}$/;
			 if (reg.test(phone)) {
			      return true;
			 }else{
			      return false;
			 }
	    }
		$('.pop1').hide()
		$('.pop2').hide()
		$(".provide-btn").on('click',function(){
			$(".pop1").show()
			$(".pop2").hide()
		})
		$(".start").on('click',function(){
			$(".pop1").hide()
			$(".pop2").show()
		})
		$("#close1").on('click',function(){
			$(".pop1").hide()
		})
		$("#close2").on('click',function(){
			$(".pop2").hide()
		})
		$("#pop1-btn").on('click',function(){
			var name = $("#name").val()
			var phone = $("#phone").val()
			if (!checkphone(phone)) {
				alert("请输入正确手机号")
				return false
			}
			$.ajax({
				url:"http://localhost:8000/volunteer/{{volunteer.id}}/signup",
				method:'POST',
				data:{ name:name, phone:phone},
				success:function(msg){
					alert(msg)
					window.location.reload()
				},
			})
		})		
	})
</script>
{% endblock %}